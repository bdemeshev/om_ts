% !TEX root = ../om_ts_08.tex

\begin{frame} % название фрагмента

\videotitle{Обнаружение структурного сдвига}

\end{frame}



\begin{frame}{Обнаружение структурного сдвига: план}
  \begin{itemize}[<+->]
    \item Что такое структурный сдвиг? 
    \item Обнаружение одного структурного сдвига. 
    \item Обнаружение нескольких структурных сдвигов. 
  \end{itemize}

\end{frame}

\begin{frame}
  \frametitle{Что считать структурным сдвигом?}

  \pause 
  Деление временного ряда на периоды между структурными сдвигами \alert{субъективно}.

  \pause
  Неформально, момент структурного сдвига \alert{меняет} поведение ряда. 

  \pause
  Что считать «меняет»?

\end{frame}


\begin{frame}
  \frametitle{Идея обнаружения отдельного сдвига}

  \begin{itemize}
    \onslide<1->{\item Стартуем со штрафной функции, измеряющей \alert{неоднородность}
    наблюдений $y_a$, $y_{a+1}$, \ldots, $y_b$,
    \[
    C(y_{a:b}).
    \]
    }
    \onslide<2->{\item Перебираем все моменты $\tau \in [1;T-1]$ и находим минимум величины
    \[
      C(y_{1:\tau}) + C(y_{\tau+1 : T}).
    \]}
    \onslide<3->{Подозреваем, что сдвиг мог быть в этот момент $\tau^*$.}
    
    \onslide<4->{\item Считаем, что сдвиг был в $\tau^*$, если 
    суммарная неоднородность фрагментов \alert{сильно} меньше неоднородности всего ряда,
    \[
      C(y_{1:\tau^*}) + C(y_{\tau^*+1 : T}) < C(y_{1:T}) - \beta.
    \]
    }
\end{itemize}

\end{frame}


\begin{frame}
  \frametitle{Выбор штрафной функции $C$}

  \begin{itemize}
    \onslide<1->{\item Есть \alert{огромное} вариантов.}
    \onslide<2->{\item Часто берут функцию лог-функцию правдоподобия \alert{некоторой} модели,
    домноженную на минус два:
    \[
      C(y_{a:b}) = -2 \max_{\theta} \ln L(y_a, \ldots, y_b \mid \theta ).
    \]
    }
    \onslide<3->{\alert{Простейший вариант}: считать, что $y_t \sim \cN(\mu, \sigma^2)$ и независимы.}
    \onslide<4->{\item Выбор функции $C$ связан с выбором $\beta$ при проверке наличия сдвига в подозрительной точке $\tau^*$,
    \[
      C(y_{1:\tau^*}) + C(y_{\tau^*+1 : T}) < C(y_{1:T}) - \beta.
    \]
    }
    \onslide<5->{Чем больше параметров в $\theta$, тем больше должно быть $\beta$.}
\end{itemize}

\end{frame}

\begin{frame}
  \frametitle{Как обнаружить много структурных сдвигов?}

  \begin{itemize}
    \onslide<1->{\item Запустить алгоритм по обнаружению \alert{одного} структурного сдвига.}
  
    \onslide<2->{Если алгоритм не обнаружил сдвиг, то считаем, что сдвигов на данном участке нет. }
    
    \onslide<3->{\item Разбиваем исходный ряд на \alert{два участка} согласно обнаруженному структурному сдвигу.}

    \onslide<4->{\item \alert{Рекурсивно} запускаем алгоритм обнаружения 
    одного структурного сдвига на \alert{каждом} обнаруженном участке. }
\end{itemize}


\end{frame}


\begin{frame}
  \frametitle{Преобразования для поиска сдвига}

  Сдвиг может \alert{легче} обнаруживаться на преобразованном ряду. 

  \begin{itemize}
    \onslide<1->{\item \alert{Простые действия} с исходным рядом: логарифм, преобразование Бокса-Кокса, переход к разностям.}

    \onslide<2->{\item Разложение на компоненты и \alert{поиск сдвига в компонентах} ряда: $STL$, $ETS$, \ldots }

\end{itemize}


\end{frame}

  

\begin{frame}
  \frametitle{Зачем искать структурные сдвиги?}

  \begin{itemize}[<+->]
    \item Иногда обнаружение сдвигов — \alert{основная задача}. 
    \item Возможность получить \alert{более точные} прогнозы, если добавить в предикторы 
    дамми-переменную равную единице после сдвига.
    \item Возможность получить \alert{более точные} прогнозы других рядов, если 
    скорректировать структурный сдвиг в предикторе.
  \end{itemize}
  

\end{frame}


\begin{frame}{Обнаружение структурного сдвига: итоги}

  \begin{itemize}[<+->]
    \item Есть \alert{куча} специальных алгоритмов.
    \item Чтобы найти \alert{много} сдвигов, достаточно поискать очередной сдвиг на 
    уже выявленных участках ряда.
    \item $STL$ разложение позволяет искать \alert{сдвиги в компонентах} ряда.
 \end{itemize}
\end{frame}

